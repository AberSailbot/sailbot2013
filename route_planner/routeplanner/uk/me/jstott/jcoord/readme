code from http://www.jstott.me.uk/jcoord
